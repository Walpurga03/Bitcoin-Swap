<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Bitcoin Tausch Netzwerk</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="styles/main.css" rel="stylesheet">
    <style>
        .glassmorphic-body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .glassmorphic-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .btn-gradient {
            background: linear-gradient(135deg, #6b46c1 0%, #ec4899 100%);
            border: none;
            border-radius: 15px;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px 0 rgba(107, 70, 193, 0.4);
        }
        
        .btn-gradient:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px 0 rgba(107, 70, 193, 0.6);
            color: white;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .offer-card {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(12px);
            border-radius: 18px;
            border: 1px solid rgba(255, 255, 255, 0.25);
            transition: all 0.3s ease;
            height: 100%;
        }
        
        .offer-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
        }
        
        .navbar-glass {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .filter-pills .nav-link {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            border-radius: 25px;
            margin: 0 5px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .filter-pills .nav-link.active,
        .filter-pills .nav-link:hover {
            background: linear-gradient(135deg, #6b46c1 0%, #ec4899 100%);
            color: white;
            border-color: transparent;
        }
        
        .crypto-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
        }
    </style>
</head>
<body class="glassmorphic-body">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-glass fixed-top">
        <div class="container">
            <a class="navbar-brand text-white fw-bold" href="#">
                <i class="bi bi-currency-bitcoin text-warning me-2"></i>
                Bitcoin Tausch
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link text-white me-3" href="my-offers.html">
                    <i class="bi bi-briefcase me-1"></i>Meine Angebote
                </a>
                <button class="btn btn-outline-light btn-sm" onclick="logout()">
                    <i class="bi bi-box-arrow-right me-1"></i>Logout
                </button>
            </div>
        </div>
    </nav>

    <div class="container" style="margin-top: 100px;">
        <!-- Welcome Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="glassmorphic-card text-center">
                    <h1 class="text-white mb-3">
                        <i class="bi bi-currency-bitcoin text-warning me-2"></i>
                        Bitcoin Tausch Dashboard
                    </h1>
                    <p class="text-white-50 mb-0">Willkommen im privaten Bitcoin-Handels-Netzwerk</p>
                    <small class="text-white-50">Angemeldet als: <span id="userInfo" class="text-warning"></span></small>
                </div>
            </div>
        </div>

        <!-- Live Stats -->
        <div class="row mb-4">
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="text-warning mb-2">
                        <i class="bi bi-graph-up-arrow fs-1"></i>
                    </div>
                    <h3 class="text-white mb-1" id="totalOffers">42</h3>
                    <p class="text-white-50 mb-0 small">Aktive Angebote</p>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="text-info mb-2">
                        <i class="bi bi-people-fill fs-1"></i>
                    </div>
                    <h3 class="text-white mb-1" id="totalMembers">18</h3>
                    <p class="text-white-50 mb-0 small">Mitglieder</p>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="text-success mb-2">
                        <i class="bi bi-currency-bitcoin fs-1"></i>
                    </div>
                    <h3 class="text-white mb-1" id="totalVolume">3.47</h3>
                    <p class="text-white-50 mb-0 small">BTC Volumen</p>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card">
                    <div class="text-danger mb-2">
                        <i class="bi bi-lightning-charge-fill fs-1"></i>
                    </div>
                    <h3 class="text-white mb-1" id="totalTrades">127</h3>
                    <p class="text-white-50 mb-0 small">Erfolgreiche Trades</p>
                </div>
            </div>
        </div>

        <!-- Filter Tabs -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="glassmorphic-card">
                    <ul class="nav nav-pills filter-pills justify-content-center flex-wrap" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-filter="alle">
                                <i class="bi bi-grid-3x3-gap me-1"></i>Alle Angebote
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-filter="verkauf">
                                <i class="bi bi-arrow-down-circle me-1"></i>Bitcoin Verkauf
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-filter="kauf">
                                <i class="bi bi-arrow-up-circle me-1"></i>Bitcoin Kauf
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-filter="tausch">
                                <i class="bi bi-arrow-left-right me-1"></i>Krypto Tausch
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Offers Grid -->
        <div class="row" id="offersContainer">
            <!-- Offers will be loaded here by JavaScript -->
        </div>
    </div>

    <!-- Interest Modal -->
    <div class="modal fade" id="interestModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content" style="background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2);">
                <div class="modal-header border-0">
                    <h5 class="modal-title text-white">Interesse zeigen</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p class="text-white mb-3">Du zeigst Interesse an diesem Angebot:</p>
                    <div id="modalOfferDetails" class="text-white-50 mb-3"></div>
                    <div class="mb-3">
                        <label class="form-label text-white">Nachricht (optional):</label>
                        <textarea class="form-control bg-dark border-secondary text-white" id="interestMessage" rows="3" placeholder="Hallo, ich interessiere mich fÃ¼r dein Angebot..."></textarea>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Abbrechen</button>
                    <button type="button" class="btn btn-gradient" onclick="sendInterest()">
                        <i class="bi bi-send me-1"></i>Interesse senden
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="config.js"></script>
    <script>
        // Demo offers data
        const demoOffers = [
            {
                id: 1,
                type: 'verkauf',
                title: '0.5 BTC zu verkaufen',
                amount: '0.5 BTC',
                price: 'â¬22,500',
                rate: 'â¬45,000/BTC',
                method: 'BankÃ¼berweisung',
                location: 'Berlin',
                memberSince: '2021',
                reputation: 98,
                trades: 47,
                description: 'Schnelle Abwicklung, bevorzuge BankÃ¼berweisung. PersÃ¶nliches Treffen in Berlin mÃ¶glich.',
                avatar: 'ð¨âð¼'
            },
            {
                id: 2,
                type: 'kauf',
                title: 'Suche 1.2 BTC',
                amount: '1.2 BTC',
                price: 'Marktpreis +2%',
                rate: 'â¬45,900/BTC',
                method: 'Cash/SEPA',
                location: 'MÃ¼nchen',
                memberSince: '2020',
                reputation: 95,
                trades: 63,
                description: 'Langzeit-Hodler, zahle faire Preise. Bar oder SEPA mÃ¶glich.',
                avatar: 'ð©âð»'
            },
            {
                id: 3,
                type: 'tausch',
                title: 'ETH â BTC Tausch',
                amount: '10 ETH â ~0.6 BTC',
                price: 'CoinGecko Rate',
                rate: 'Live Rate',
                method: 'DeFi/Wallet',
                location: 'Online',
                memberSince: '2022',
                reputation: 92,
                trades: 28,
                description: 'Tausche regelmÃ¤Ãig zwischen ETH und BTC. Nutze vertrauenswÃ¼rdige DeFi-Protokolle.',
                avatar: 'ð'
            },
            {
                id: 4,
                type: 'verkauf',
                title: '2.1 BTC GroÃverkauf',
                amount: '2.1 BTC',
                price: 'â¬94,500',
                rate: 'â¬45,000/BTC',
                method: 'Gold/Silber/Cash',
                location: 'Hamburg',
                memberSince: '2019',
                reputation: 99,
                trades: 156,
                description: 'Akzeptiere auch Edelmetalle. Habe physisches Gold/Silber vorrÃ¤tig. SeriÃ¶se Anfragen nur.',
                avatar: 'ð¥'
            },
            {
                id: 5,
                type: 'kauf',
                title: 'Kaufe 0.8 BTC',
                amount: '0.8 BTC',
                price: 'â¬35,600',
                rate: 'â¬44,500/BTC',
                method: 'Bargeld',
                location: 'KÃ¶ln',
                memberSince: '2021',
                reputation: 94,
                trades: 34,
                description: 'Bevorzuge persÃ¶nliche Treffen mit Bargeld. Diskret und zuverlÃ¤ssig.',
                avatar: 'ð°'
            },
            {
                id: 6,
                type: 'tausch',
                title: 'XMR â BTC Tausch',
                amount: 'Variable',
                price: 'Spot Rate',
                rate: 'Live Market',
                method: 'Privacy Coins',
                location: 'Online',
                memberSince: '2020',
                reputation: 96,
                trades: 89,
                description: 'Spezialisiert auf Privacy-Coin-Tausch. Absolute Diskretion garantiert.',
                avatar: 'ð'
            }
        ];

        function getTypeColor(type) {
            switch(type) {
                case 'verkauf': return 'danger';
                case 'kauf': return 'success';
                case 'tausch': return 'warning';
                default: return 'secondary';
            }
        }

        function getTypeIcon(type) {
            switch(type) {
                case 'verkauf': return 'arrow-down-circle';
                case 'kauf': return 'arrow-up-circle';
                case 'tausch': return 'arrow-left-right';
                default: return 'circle';
            }
        }

        function renderOffers(filter = 'alle') {
            const container = document.getElementById('offersContainer');
            const filteredOffers = filter === 'alle' ? demoOffers : demoOffers.filter(offer => offer.type === filter);
            
            container.innerHTML = filteredOffers.map(offer => `
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="offer-card p-4">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <span class="badge bg-${getTypeColor(offer.type)} bg-gradient px-3 py-2">
                                <i class="bi bi-${getTypeIcon(offer.type)} me-1"></i>
                                ${offer.type.toUpperCase()}
                            </span>
                            <div class="text-end">
                                <div class="text-warning fw-bold">
                                    <i class="bi bi-star-fill me-1"></i>${offer.reputation}%
                                </div>
                                <small class="text-white-50">${offer.trades} Trades</small>
                            </div>
                        </div>
                        
                        <div class="d-flex align-items-center mb-3">
                            <div class="me-3" style="font-size: 2rem;">${offer.avatar}</div>
                            <div>
                                <h5 class="text-white mb-1">${offer.title}</h5>
                                <small class="text-white-50">Mitglied seit ${offer.memberSince}</small>
                            </div>
                        </div>
                        
                        <div class="row g-2 mb-3">
                            <div class="col-6">
                                <div class="text-white-50 small">Menge:</div>
                                <div class="text-white fw-bold">${offer.amount}</div>
                            </div>
                            <div class="col-6">
                                <div class="text-white-50 small">Preis:</div>
                                <div class="text-warning fw-bold">${offer.price}</div>
                            </div>
                            <div class="col-6">
                                <div class="text-white-50 small">Rate:</div>
                                <div class="text-info">${offer.rate}</div>
                            </div>
                            <div class="col-6">
                                <div class="text-white-50 small">Methode:</div>
                                <div class="text-white">${offer.method}</div>
                            </div>
                            <div class="col-12">
                                <div class="text-white-50 small">Ort:</div>
                                <div class="text-white">
                                    <i class="bi bi-geo-alt me-1"></i>${offer.location}
                                </div>
                            </div>
                        </div>
                        
                        <p class="text-white-50 small mb-3" style="font-size: 0.85rem;">${offer.description}</p>
                        
                        <button class="btn btn-gradient w-100" onclick="showInterest(${offer.id})">
                            <i class="bi bi-hand-thumbs-up me-1"></i>Interesse zeigen
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showInterest(offerId) {
            const offer = demoOffers.find(o => o.id === offerId);
            if (offer) {
                document.getElementById('modalOfferDetails').innerHTML = `
                    <strong>${offer.title}</strong><br>
                    <small>Menge: ${offer.amount} â¢ Preis: ${offer.price} â¢ Ort: ${offer.location}</small>
                `;
                const modal = new bootstrap.Modal(document.getElementById('interestModal'));
                modal.show();
                window.currentOfferId = offerId;
            }
        }

        function sendInterest() {
            const message = document.getElementById('interestMessage').value;
            const offerId = window.currentOfferId;
            const offer = demoOffers.find(o => o.id === offerId);
            
            // Simulate sending interest
            const modal = bootstrap.Modal.getInstance(document.getElementById('interestModal'));
            modal.hide();
            
            // Show success message
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert alert-success alert-dismissible fade show position-fixed';
            alertDiv.style = 'top: 120px; right: 20px; z-index: 9999;';
            alertDiv.innerHTML = `
                <i class="bi bi-check-circle me-2"></i>
                <strong>Interesse gesendet!</strong> Du wirst benachrichtigt, wenn der Anbieter antwortet.
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            document.body.appendChild(alertDiv);
            
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.parentNode.removeChild(alertDiv);
                }
            }, 5000);
            
            console.log(`Interest sent for offer ${offerId}:`, message);
        }

        function logout() {
            sessionStorage.clear();
            window.location.href = 'start.html';
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            const authorizedNpub = sessionStorage.getItem('authorized_npub');
            if (!authorizedNpub) {
                window.location.href = 'start.html';
                return;
            }

            // Show user info
            document.getElementById('userInfo').textContent = authorizedNpub.substring(0, 20) + '...';

            // Load offers
            renderOffers();
            
            // Add filter event listeners
            document.querySelectorAll('[data-filter]').forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Update active state
                    document.querySelectorAll('[data-filter]').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Filter offers
                    const filter = this.getAttribute('data-filter');
                    renderOffers(filter);
                });
            });

            // Animate stats
            animateStats();
        });

        function animateStats() {
            setTimeout(() => {
                document.getElementById('totalOffers').textContent = Math.floor(Math.random() * 20) + 35;
                document.getElementById('totalVolume').textContent = (Math.random() * 2 + 3).toFixed(2);
                document.getElementById('totalTrades').textContent = Math.floor(Math.random() * 50) + 120;
            }, 1000);
        }
    </script>
</body>
</html>
